using System.Text.Json;
using NUnit.Framework;

namespace Json.Schema.Tests;

public class JsonMathTests
{
	[TestCase("42", "42", 0)]
	[TestCase("3.14159", "3.14159", 0)]
	[TestCase("1.0", "1", 0)]
	[TestCase("0.5", "0.50", 0)]
	[TestCase("1.23e2", "123", 0)]
	[TestCase("1.23e-2", "0.0123", 0)]
	[TestCase("0", "0.0", 0)]
	[TestCase("5", "10", -1)]
	[TestCase("3.14", "3.15", -1)]
	[TestCase("0.5", "5", -1)]
	[TestCase("1e2", "1e3", -1)]
	[TestCase("0.001", "0.01", -1)]
	[TestCase("100", "50", 1)]
	[TestCase("7.89", "7.88", 1)]
	[TestCase("5e10", "5e9", 1)]
	[TestCase("-42", "-42", 0)]
	[TestCase("-10", "-5", -1)]
	[TestCase("-5", "-10", 1)]
	[TestCase("-5", "5", -1)]
	[TestCase("5", "-5", 1)]
	[TestCase("-3.14", "-3.15", 1)]
	[TestCase("-1e5", "-1e4", -1)]
	[TestCase("0", "1", -1)]
	[TestCase("0", "-1", 1)]
	[TestCase("999999999999999", "1000000000000000", -1)]
	[TestCase("0.0000001", "0.0000002", -1)]
	[TestCase("1.5e+10", "15000000000", 0)]
	[TestCase("5e2", "500", 0)]
	[TestCase("123", "124", -1)]
	[TestCase("999", "998", 1)]
	[TestCase("1.234567890123456", "1.234567890123457", -1)]
	[TestCase("5.0", "5.00", 0)]
	[TestCase("1e308", "1e307", 1)]
	[TestCase("1e-308", "1e-307", -1)]
	[TestCase("10", "10.5", -1)]
	[TestCase("0.00001", "1e-5", 0)]
	[TestCase("0", "-0", 0)]
	[TestCase("1.0000000000000001", "1.0000000000000002", -1)]
	[TestCase("12345678901234567890", "12345678901234567891", -1)]
	[TestCase("123", "1234", -1)]
	[TestCase("1.5E10", "1.5e10", 0)]
	[TestCase("0.1", "0.2", -1)]
	[TestCase("0.12", "0.13", -1)]
	[TestCase("0.12", "0", 1)]
	[TestCase("0.0", "0.6", -1)]
	public void NumberCompare(string aJson, string bJson, int expected)
	{
		var a = JsonDocument.Parse(aJson).RootElement;
		var b = JsonDocument.Parse(bJson).RootElement;
		
		Assert.That(JsonMath.NumberCompare(a, b), Is.EqualTo(expected));
	}

	[TestCase("10", "5", true)]
	[TestCase("10", "3", false)]
	[TestCase("100", "10", true)]
	[TestCase("100", "7", false)]
	[TestCase("15", "3", true)]
	[TestCase("15", "4", false)]
	[TestCase("0", "5", true)]
	[TestCase("5", "0", false)]
	[TestCase("0", "0", false)]
	[TestCase("1", "1", true)]
	[TestCase("42", "1", true)]
	[TestCase("1", "2", false)]
	[TestCase("0.5", "0.25", true)]
	[TestCase("0.5", "0.3", false)]
	[TestCase("1.5", "0.5", true)]
	[TestCase("1.5", "0.4", false)]
	[TestCase("3.6", "1.2", true)]
	[TestCase("3.6", "1.1", false)]
	[TestCase("0.1", "0.05", true)]
	[TestCase("0.1", "0.03", false)]
	[TestCase("100", "0.5", true)]
	[TestCase("100", "0.3", false)]
	[TestCase("1e2", "10", true)]
	[TestCase("1e2", "7", false)]
	[TestCase("1e3", "1e2", true)]
	[TestCase("1e3", "3e2", false)]
	[TestCase("5e10", "5e9", true)]
	[TestCase("5e10", "3e9", false)]
	[TestCase("1.23e2", "41", true)]
	[TestCase("1.23e2", "40", false)]
	[TestCase("0.001", "0.0005", true)]
	[TestCase("0.001", "0.0003", false)]
	[TestCase("-10", "5", true)]
	[TestCase("-10", "3", false)]
	[TestCase("10", "-5", true)]
	[TestCase("10", "-3", false)]
	[TestCase("-10", "-5", true)]
	[TestCase("-10", "-3", false)]
	[TestCase("1000000", "1000", true)]
	[TestCase("1000000", "999", false)]
	[TestCase("99999", "33333", true)]
	[TestCase("99999", "33334", false)]
	[TestCase("0.0000001", "0.00000005", true)]
	[TestCase("0.0000001", "0.00000003", false)]
	[TestCase("144", "12", true)]
	[TestCase("144", "13", false)]
	[TestCase("256", "16", true)]
	[TestCase("256", "15", false)]
	[TestCase("1024", "32", true)]
	[TestCase("1024", "31", false)]
	[TestCase("7.5", "2.5", true)]
	[TestCase("7.5", "2.0", false)]
	[TestCase("12.5", "2.5", true)]
	[TestCase("12.5", "3.0", false)]
	[TestCase("0.125", "0.025", true)]
	[TestCase("0.125", "0.03", false)]
	[TestCase("1000", "125", true)]
	[TestCase("1000", "111", false)]
	[TestCase("9999", "3", true)]
	[TestCase("9999", "4", false)]
	[TestCase("1.00", "0.25", true)]
	[TestCase("1.00", "0.3", false)]
	[TestCase("50", "0.5", true)]
	[TestCase("50", "0.7", false)]
	[TestCase("1.2345678901234567890", "0.12345678901234567890", true)]
	[TestCase("1.2345678901234567890", "0.11111111111111111111", false)]
	[TestCase("9999999999999999999", "3333333333333333333", true)]
	[TestCase("9999999999999999999", "3333333333333333334", false)]
	[TestCase("0.123456789012345678901234567890", "0.00123456789012345678901234567890", true)]
	[TestCase("0.123456789012345678901234567890", "0.00111111111111111111111111111111", false)]
	[TestCase("999999999999999999999999999999", "111111111111111111111111111111", true)]
	[TestCase("999999999999999999999999999999", "111111111111111111111111111112", false)]
	[TestCase("1e20", "1e10", true)]
	[TestCase("1e20", "3e10", false)]
	[TestCase("1.23456789e15", "123456789", true)]
	[TestCase("1.23456789e15", "123456788", false)]
	public void Divides(string dividendJson, string divisorJson, bool expected)
	{
		var dividend = JsonDocument.Parse(dividendJson).RootElement;
		var divisor = JsonDocument.Parse(divisorJson).RootElement;
		
		Assert.That(JsonMath.Divides(dividend, divisor), Is.EqualTo(expected));
	}
}
